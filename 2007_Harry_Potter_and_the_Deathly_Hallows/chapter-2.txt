etst
Changes from the book7 branch